#!/bin/bash

script/branding

set -e

if [[ -z "$TEST_DIR" ]]
then
  echo "Unknown test directory"
  exit 1
else
    cd $TEST_DIR
#    clang -coverage -O0 main.c -o main $ARGS && { [ -z $RUN ] && ./main || echo "skipped ./main"; }
    gcc -coverage main.c -o main $ARGS && { [ -z $RUN ] && ./main || echo "skipped ./main"; }
    gcov main.c && bash <(curl -s https://codecov.io/bash)
    cd -
fi
